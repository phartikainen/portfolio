"use strict";var directives=angular.module("myApp.directives",[]);directives.directive("appVersion",["version",function(e){return function(t,n,r){n.text(e)}}]);directives.directive("fastClick",[function(){return{restrict:"A",link:function(e,t,n){FastClick.attach(t[0])}}}]);directives.directive("toggleButton",[function(){return{restrict:"A",link:function(e,t,n){t.addClass("togglebut");var r=$("ul",t),i=$("i",t),s=!1;$("button",t).click(function(){if(s){r.toggle(150);i.addClass("exp");i.removeClass("col")}else{r.toggle(150);i.addClass("col");i.removeClass("exp")}s=!s})}}}]);directives.directive("menuButton",[function(){return{restrict:"A",link:function(e,t,n){var r=$("nav.mainnavi"),i=$("i",t),s=!1;$("#menubut",t).click(function(e){if(s){r.hide();i.addClass("menu");i.removeClass("close")}else{r.show();i.addClass("close");i.removeClass("menu")}s=!s;e.stopPropagation()});$(".expand").on("click",function(e){e.stopPropagation()});$(document,t).click(function(){if(s){r.hide();i.addClass("menu");i.removeClass("close");s=!s}})}}}]);directives.directive("phImg",function(){return{restrict:"A",scope:{dimensions:"@phImg"},link:function(e,t,n){function s(){var t=[e.size.h,e.size.w].sort(),n=Math.round(t[1]/16);return Math.max(i.text_size,n)}function o(){r=r||document.createElement("canvas");var t=r.getContext("2d"),n,o;r.width=e.size.w;r.height=e.size.h;t.fillStyle=i.fill_color;t.fillRect(0,0,e.size.w,e.size.h);n=s();o=e.dimensions;t.fillStyle=i.text_color;t.textAlign="center";t.textBaseline="middle";t.font="bold "+n+"pt sans-serif";if(t.measureText(o).width/e.size.w>1){n=i.text_size/(t.measureText(o).width/e.size.w);t.font="bold "+n+"pt sans-serif"}t.fillText(e.dimensions,e.size.w/2,e.size.h/2);return r.toDataURL("image/png")}var r,i={text_size:10,fill_color:"#EEEEEE",text_color:"#AAAAAA"};e.$watch("dimensions",function(){if(!angular.isDefined(e.dimensions))return;var n=e.dimensions.match(/^(\d+)x(\d+)$/),r;if(!n){console.error("Expected '000x000'. Got "+e.dimensions);return}e.size={w:n[1],h:n[2]};t.prop("title",e.dimensions);t.prop("alt",e.dimensions);r=o();t.prop("tagName")==="IMG"?t.prop("src",r):t.css("background-image",'url("'+r+'")')})}}});directives.directive("phTxt",["TextGeneratorService",function(e){return{restrict:"EA",priority:1,controller:["$scope","$element","$attrs",function(t,n,r){function o(){var t;s||!i?t=e.createParagraphs(s,i):t=e.createSentences(i);n.html(t)}var i,s;r.$observe("phTxt",function(e){var t,n;t=e.match(/(\d+)p/);n=e.match(/(\d+)s/);t!==null?s=parseInt(t[1],10):s=!1;n!==null?i=parseInt(n[1],10):i=!1;o()});r.phTxt||o()}]}}]);directives.directive("firstWords",[function(){return{restrict:"A",priority:0,link:function(e,t,n){var r=3,i=t.contents().filter(function(){return this.nodeType==3}).first(),s=i.text(),o=s.split(" ",r).join(" ");if(!i.length)return;i[0].nodeValue=s.slice(o.length);i.before("<span>"+o+"</span>")}}}]);